<!-- authors: Ricky Perez & Michael Loptien -->
<% provide(:title, "All students") %>

<!-- page header -->
<%= render partial: 'schools/school_page_header', 
			:locals => { 	:title => "All students", 
										:subtitle => "view/manage all students at #{ @school.full_name }"} %>

<!-- Start with student info and the New Student button -->
<div class="row first-content-row">
	<div class="col-xs-5 col-xs-offset-1">
    <h4>There are <%= @students.count %> students at <%= @school.full_name %>. </h4>
  </div>
  <div class="col-xs-5 text-center">
    <%= button_to new_student_path, method: :get, class: 'btn btn-lg btn-success' do %>
  		<span class="fa fa-fw fa-lg fa-plus-square-o"></span> New Student
		<% end %>
  </div>
</div>

<!-- Start of Table -->
<div class="row">
  <div class="col-xs-10 col-xs-offset-1">

<table class="table table-striped table-hover table-responsive schools-table">

  <!-- Table Header -->
  <thead>
    <tr>
      <th></th> <!-- blank for student icon -->
      <th>ID</th>
      <th>Name</th>
      <th>Last Session</th>
    </tr>
  </thead>

  <!-- Table Body -->
  <tbody>
    <% @students.each do |student| %>

      <!--Make the entire line a link--> 
      <tr data-link = "<%= edit_student_path(student) %>">

        <!-- Display the students symbol + color comdo --> 
        <td>
          <div class="table-sq i-<%= student.color %>">
            <span class="fa fa-lg fa-fw fa-<%= student.icon %> table-icon"></span>
				  </div>
        </td>
        
        <!-- Displays the students screen name -->
        <td><%= student.screen_name %></td>

        <!-- Displays the student full name -->
        <td><%= student.full_name %></td>
        
        <!-- Displays the students last ran session -->
        <% this_session = @sessions.where(session_student: student.id).last %>
        <% if this_session != nil %>
          <td><%= this_session.end_time %></td>
        <% else %>
          <td>No previous sessions</td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>
<%= will_paginate %>

  </div>   <!-- col -->
</div>   <!-- row -->
